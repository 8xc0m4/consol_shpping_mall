import 'dart:io'; //dartì—ì„œ ì œê³µí•˜ëŠ” ì…ì¶œë ¥ ê¸°ëŠ¥ ì‚¬ìš©
import '../lib/product.dart'; //productíŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
import '../lib/shopping_mall.dart'; //shopping_mallíŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°

//[dart run bin/main.dart] <= ì‹¤í–‰í•˜ê¸° (TERMINAL)
void main() {
  //ë©”ì¸ í•¨ìˆ˜
  final mall = ShoppingMall([
    // ShoppingMallì´ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•´ì„œ mallì´ë¼ëŠ” ì‡¼í•‘ëª° ê°ì²´ë¥¼ í•˜ë‚˜ ë§Œë“¬, finalì€ í•œ ë²ˆë§Œ ê°’ì„ ì •í•  ìˆ˜ ìˆëŠ” ë³€ìˆ˜
    Product('ì…”ì¸ ', 45000), // ìƒí’ˆ ë¦¬ìŠ¤íŠ¸
    Product('ì›í”¼ìŠ¤', 30000),
    Product('ë°˜íŒ”í‹°', 35000),
    Product('ë°˜ë°”ì§€', 38000),
    Product('ì–‘ë§', 5000),
  ]);

  bool running = true; //runningì´ë¼ëŠ” ë³€ìˆ˜ë¥¼ ë§Œë“¤ì—ˆìŒ, trueëŠ” í”„ë¡œê·¸ë¨ì´ ê³„ì† ì‹¤í–‰ì¤‘, ì¢…ë£Œí•˜ë©´ false

  print('ğŸ›’ ì‡¼í•‘ëª°ì— ì˜¤ì‹  ê±¸ í™˜ì˜í•©ë‹ˆë‹¤!');

  while (running) {
    //runningì´ trueì¸ ë™ì•ˆ ê³„ì† ë°˜ë³µ
    print(
        '\n--------------------------------------------------------------------------------------------');
    print(
        '\n[1] ìƒí’ˆ ëª©ë¡ ë³´ê¸° / [2] ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸° / [3] ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸´ ìƒí’ˆì˜ ì´ ê°€ê²© ë³´ê¸° / [4] í”„ë¡œê·¸ë¨ ì¢…ë£Œ');
    print(
        '\n--------------------------------------------------------------------------------------------');
    stdout.write('ì›í•˜ëŠ” ê¸°ëŠ¥ì˜ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”: '); //ì½˜ì†”ì—ì„œ ì‚¬ìš©ìì—ê²Œ ì…ë ¥ì„ ë°›ëŠ” ë¶€ë¶„
    final input = stdin.readLineSync(); //ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë¬¸ìë¥¼ ì½ìŒ

    switch (input) {
      //ì…ë ¥ ë°›ì€ ê°’ì— ë”°ë¼ ê° ì‘ì—… ì‹¤í–‰
      case '1': //ìƒí’ˆ ëª©ë¡ ë³´ì—¬ì£¼ê¸°
        mall.showProducts();
        break;
      case '2': //ìƒí’ˆ ì´ë¦„, ê°œìˆ˜ë¥¼ ì…ë ¥ë°›ê³  ì¥ë°”êµ¬ë‹ˆì— ë‹´ìŒ-----ì—ëŸ¬ë‚¨(ìƒí’ˆì„ ì…ë ¥í•˜ê³  ì–´ë–¤ ê°œìˆ˜ë¥¼ ì…ë ¥í•˜ë“  ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ì§€ ì•Šë‹¤ê³  í•¨)
        stdout.write('ìƒí’ˆ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”: ');
        final name = stdin.readLineSync();
        stdout.write('ìƒí’ˆ ê°œìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”: ');
        final quantityInput = stdin.readLineSync();

        if (name == null || quantityInput == null) {
          print('ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ì§€ ì•Šì•„ìš” !');
          break;
        }

        try {
          final quantity = int.parse(quantityInput);
          mall.addToCart(name, quantity);
        } catch (e) {
          print('ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ì§€ ì•Šì•„ìš” !');
        }
        break;
      case '3': //ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸´ ìƒí’ˆë“¤ì˜ ì´ ê°€ê²© ì•Œë ¤ì¤Œ
        mall.showTotal();
        break;
      case '4': //ì¢…ë£Œë²„íŠ¼, runningì´ falseê°€ ë¨
        print('ì´ìš©í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤ ~ ì•ˆë…•íˆ ê°€ì„¸ìš” !');
        running = false;
        break;
      default: //ë‹¤ë¥¸ ë²ˆí˜¸ ì…ë ¥ì‹œ ì˜¤ë¥˜ë¬¸ì ì¶œë™
        print('ì§€ì›í•˜ì§€ ì•ŠëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤ ! ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš” ..');
    }
  }
}
